# 3.3 The Complete Solution to $Ax = b$

## General Idea
- The **complete solution** of a linear system $Ax = b$ is:
  $$
  x = x_p + x_n
  $$
  where:
  - $x_p$ = **one particular solution** of $Ax = b$
  - $x_n$ = **any vector in the nullspace** of $A$, i.e., solution to $Ax = 0$

- Strategy:
  1. Form the **augmented matrix** $[A \, b]$.
  2. Apply elimination to reduce to $[R \, d]$, where $R$ is in row echelon form.
  3. Solve $Rx = d$ for pivot variables in terms of free variables.

---

## Row Reduction and Solvability
- $Ax = b$ is equivalent to $Rx = d$ after elimination.
- **Condition for solvability**:
  - Any **zero row** in $R$ must correspond to a zero in the same row of $d$.
  - Otherwise, the system is inconsistent.
- Example:
  $$
  [R \, d] = 
  \begin{bmatrix}
  1 & 3 & 0 & 2 & 1 \\
  0 & 0 & 1 & 4 & 6 \\
  0 & 0 & 0 & 0 & 0
  \end{bmatrix}
  $$
  - Third row: $0 = 0$ → consistent system.

---

## Particular Solution $x_p$
- **Method**:
  1. Set all **free variables** to zero.
  2. Solve for **pivot variables** using $Rx = d$.
- Example:
  - Free variables: $x_2 = x_4 = 0$
  - Pivot variables: $x_1 = 1$, $x_3 = 6$
  - Particular solution:
    $$
    x_p = \begin{bmatrix} 1 \\ 0 \\ 6 \\ 0 \end{bmatrix}
    $$

---

## Nullspace Solution $x_n$
- Solve $Ax = 0$ (or $Rx = 0$ after reduction)
- Free variables can be set to 1 or -1 to generate **special solutions**.
- Example with two free variables $x_2, x_4$:
  - $x_n^{(1)}$ corresponds to $x_2 = 1, x_4 = 0$
  - $x_n^{(2)}$ corresponds to $x_2 = 0, x_4 = 1$
- The **complete solution**:
  $$
  x = x_p + c_1 x_n^{(1)} + c_2 x_n^{(2)}, \quad c_1,c_2 \in \mathbb{R}
  $$

---

## Special Case: Square Invertible Matrix
- If $A$ is **square and invertible** ($m = n = r$):
  - Nullspace: $N(A) = \{0\}$
  - Only one solution exists:
    $$
    x = x_p = A^{-1}b
    $$
  - No free variables, no special solutions.

---

## Full Column Rank (Tall Matrix, $r = n$)
- Properties:
  1. All columns are **pivot columns**.
  2. **No free variables**.
  3. Nullspace contains only $0$: $N(A) = \{0\}$.
  4. Ax = b may or may not be solvable:
     - **Consistent system** → exactly one solution.
     - **Inconsistent system** → no solution.
- Geometrically:
  - Columns of $A$ are **linearly independent**.
  - $Ax = b$ is solvable only if $b$ lies in the **column space** of $A$.

---

## Overdetermined Systems ($m > n$)
- $A$ has full column rank $r = n$:
  - $m-n$ zero rows appear in $R$ after elimination.
  - **Consistency condition**: corresponding entries in $d$ must be zero.
  - If consistent → unique solution
  - If inconsistent → no solution
- The **right-hand side $b$ must satisfy** $m-n$ conditions to lie in the column space.

---

## Summary Table of Cases
| Rank $r$ | System type | Free variables | Nullspace | Solution existence |
|----------|-------------|----------------|-----------|------------------|
| $r=m=n$ | square invertible | 0 | $0$ | unique |
| $r=m<n$ | tall matrix | $n-m$ | nonzero | unique if $b$ consistent |
| $r=n<m$ | wide matrix | 0 | 0 | may have 0 or 1 solutions |
| $r<m, r<n$ | rank-deficient | $n-r$ | nonzero | 0 or infinitely many |

---

## Key Concepts
1. **Complete solution** = particular solution + nullspace solution.
2. **Pivot variables**: determined from $d$.
3. **Free variables**: parameterize nullspace.
4. **Consistency**: zero rows in $R$ must correspond to zeros in $d$.
5. Full column rank → independent columns → unique solution (if consistent).
6. Overdetermined systems require $b$ to satisfy certain conditions to be solvable.
7. MATLAB and other tools efficiently compute $x_p$ and $x_n$.

---

## Magyar összefoglaló
- A lineáris egyenletrendszer teljes megoldása: **x = xp + xn**
  - $x_p$ = egy konkrét megoldás
  - $x_n$ = nulltérből származó megoldás
- Sorredukcióval $[A \, b] \to [R \, d]$ az egyenlet $Ax=b$ ekvivalens $Rx=d$-vel.
- Megoldhatóság feltétele: a null sorok $R$-ben nulla értékűek legyenek $d$-ben is.
- Konkrét megoldás: szabad változók = 0, pivot változók $d$-ből.
- Nulltér: szabad változók 1 vagy -1, pivot változók visszaszámolva.
- Teljes megoldás: $x = x_p + c_1 x_n^{(1)} + c_2 x_n^{(2)} + \dots$
- Négy eset: invertibilis, full column rank, wide matrix, rank-deficient.
- Full column rank esetén az oszlopok függetlenek, nulltér $0$, egyetlen megoldás ha $b$ benne van az oszloptérben.

# 3.3 The Complete Solution to $Ax = b$ (continued)

## Full Column Rank (r = n)
- **Definition**: A matrix $A$ has **full column rank** if its rank $r$ equals the number of columns $n$.
- **Properties**:
  1. All columns are **pivot columns** → no free variables.
  2. Nullspace $N(A) = \{0\}$ → only solution to $Ax = 0$ is $x = 0$.
  3. If $Ax = b$ is solvable, it has **exactly one solution**.
  4. $A$ has **independent columns**.
- **Additional fact**:
  - For square $A$ ($n = m$), $A^T A$ is invertible when $r = n$.
- **Consistency condition**:
  - For $m > n$ (overdetermined), the $m-n$ zero rows in $R$ impose $m-n$ conditions on $b$.
- **Summary**: Full column rank → solution exists or not; if exists, unique.

---

## Full Row Rank (r = m)
- **Definition**: A matrix $A$ has **full row rank** if its rank $r$ equals the number of rows $m$.
- **Properties**:
  1. All rows have pivots, no zero rows in $R$.
  2. $Ax = b$ has a solution for **every $b \in \mathbb{R}^m$**.
  3. Column space $C(A) = \mathbb{R}^m$.
  4. Nullspace has $n-m$ free variables → infinitely many solutions.
- **Example** (short and wide matrix, $m=2$, $n=3$):
  $$
  \begin{cases}
  x + y + z = 3 \\
  x + 2y - z = 4
  \end{cases}, \quad r = m = 2
  $$
  - Geometric interpretation: two planes in $\mathbb{R}^3$ intersect in a line.
  - **Particular solution** $x_p$ = a point on the line (e.g., $x_3 = 0$ → $x_p = [2,1,0]^T$)
  - **Nullspace solution** $x_n$ = any multiple of special vector $s = [-3, 2, 1]^T$.
  - **Complete solution**:
    $$
    x = x_p + c \cdot x_n, \quad c \in \mathbb{R}
    $$
  - Interpretation: $x_n$ moves along the line of solutions.

---

## General Classification by Rank
- Let $r = \text{rank}(A)$, $m = \text{rows}$, $n = \text{columns}$. Four possibilities:

| Rank & Shape | Free variables | Nullspace | Solution type |
|------|-------------|----------------|-----------|---------------|
| $r = m = n$ | Square, invertible | 0 | $\{0\}$ | 1 solution |
| $r = m < n$ | Short & wide | $n-m$ | nonzero | infinitely many solutions |
| $r = n < m$ | Tall & thin | 0 | $\{0\}$ | 0 or 1 solution (Ax = b may be inconsistent) |
| $r < m, r < n$ | Rank-deficient | $n-r$ | nonzero | 0 or infinitely many solutions |

- **Implications for $R$ (row-reduced echelon form)**:
  - Pivot columns correspond to rank $r$.
  - For solvability, augmented vector $d$ must have **zeros in the rows corresponding to the zero rows of $R$**.
  - Cases 1 & 2 → full row rank ($r = m$)
  - Cases 1 & 3 → full column rank ($r = n$)
  - Case 4 → general rank-deficient (least common in practice)

---

## Summary
- **Full column rank ($r=n$)** → unique solution if consistent; nullspace = $\{0\}$.
- **Full row rank ($r=m$)** → solution exists for all $b$; nullspace dimension = $n-m$.
- **Complete solution formula**:
  $$
  x = x_p + \sum c_i x_n^{(i)}, \quad c_i \in \mathbb{R}
  $$
- **Geometric interpretation**:
  - Full column rank: solution = unique point (if exists)
  - Full row rank: solution = line/plane/etc. along nullspace directions.
- **Key takeaway**: Rank determines the type of solutions, free variables, and nullspace structure.

---

## Magyar összefoglaló
- Teljes oszloprang ($r=n$): minden oszlop pivot, nulltér = 0, ha van megoldás → egyedi.
- Teljes sorszám ($r=m$): minden sor pivot, minden $b$-re megoldható, nulltér $n-m$ dimenziós.
- Négy fő eset a rangtól függően:
  1. $r=m=n$ → egyetlen megoldás
  2. $r=m<n$ → végtelen megoldás
  3. $r=n<m$ → 0 vagy 1 megoldás
  4. $r<m, r<n$ → 0 vagy végtelen megoldás
- Teljes megoldás: $x = x_p + x_n$, ahol $x_n$ nulltérből jön, $x_p$ egy konkrét megoldás.
- Geometria: a nulltér iránya határozza meg a megoldások "irányát" (vonal, sík, stb.).